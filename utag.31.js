//tealium universal tag - utag.31 ut4.0.202311162320, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1,"link":1};u.scriptrequested=false;u.set_config=false;var DEFAULT_LIBRARY_VERSION='2.16.0'
u.deepMergeObject=function(targetObject,sourceObject){targetObject=targetObject||{};sourceObject=sourceObject||{};var copyTargetObject=JSON.parse(JSON.stringify(targetObject));var copySourceObject=JSON.parse(JSON.stringify(sourceObject));Object.keys(copySourceObject).forEach(function(key){if(typeof copySourceObject[key]==="object"&&!Array.isArray(copySourceObject[key])){copyTargetObject[key]=u.deepMergeObject(copyTargetObject[key],copySourceObject[key]);}else{copyTargetObject[key]=copySourceObject[key];}});return copyTargetObject;}
u.map_func=function(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){u.map_func(arr,obj[i],item);}else{obj[i]=item;}};u.clearEmptyKeys=function(object){for(var key in object){if(object[key]===""||object[key]===undefined){delete object[key];}}
return object;};u.toBoolean=function(val){val=val||"";return val===true||val.toLowerCase()==="true"||val.toLowerCase()==="on";};u.productList=function(){var SKU=u.data.product.SKU;if(!u.data.product.SKU.length){SKU=getProp(u.data,'xdm.productListItems.SKU',[])}
return SKU.map(function(skuItem,index){return u.clearEmptyKeys({SKU:u.data.product.SKU[index],name:u.data.product.name[index],priceTotal:u.data.product.priceTotal[index],quantity:u.data.product.quantity[index],lineItemId:u.data.product.lineItemId[index]});});};u.flattenTargetValues=function(data){if(data&&data.__adobe&&data.__adobe.target){u.flattenListTargetDataKeys.forEach(function(key){if(!data.__adobe.target[key]){return;}
var flattenObject=u.flattenObject(data.__adobe.target[key],key)
utag.ut.merge(data.__adobe.target,flattenObject,1);delete data.__adobe.target[key];})}}
u.flattenObject=function(obj,prefix){prefix=prefix||''
return Object.keys(obj).reduce(function(acc,k){var pre=prefix.length?prefix+'.':'';if(typeof obj[k]==='object'){utag.ut.merge(acc,u.flattenObject(obj[k],pre+k),1);}
else acc[pre+k]=obj[k];return acc;},{});}
u.flattenListTargetDataKeys=['entity','user','profile']
function getProp(object,keys,defaultVal){keys=Array.isArray(keys)?keys:keys.split('.');object=object[keys[0]];if(object&&keys.length>1){return getProp(object,keys.slice(1),defaultVal);}
return object===undefined?defaultVal:object;}
u.map={"adobeDatastream":"edgeConfigId"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['ut.env'];if(typeof d=='undefined')return;c=[{'prod':'c48cde25-8fef-4d2b-92b4-31785d4d433d'},{'qa':'3d2405e5-8d61-4306-a14f-c72cef45a238'},{'dev':'3d2405e5-8d61-4306-a14f-c72cef45a238'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['adobeDatastream']=c[e][f];m=true};};if(m)break};if(!m)b['adobeDatastream']='77401448-7de2-40b2-931f-6e05802b2c4d';}}];u.send=function(utag_event,data_layer){if(u.ev[utag_event]||u.ev.all!==undefined){utag.DB("send:31");utag.DB(data_layer);var a,b,c,d,e,f,h,config,standard_commerce_event_match=/commerce\.(?:checkouts|productListAdds|productListOpens|productListRemovals|productListReopens|productListViews|productViews|purchases|saveForLaters)/;a=utag_event;b=data_layer;u.data={base_url:"https://cdn1.adoberesources.net/alloy/##utag_replace_library_version##/alloy.min.js",library_version:"2.16.0",auto_purchase_tracking:'false',auto_page_tracking:'false',commandCallback:function(){},instanceName:"alloy"||"alloy",edgeConfigId:"68a9d23f-3aaa77401448-7de2-40b2-931f-6e05802b2c4d42c0-8bde-6fcf6aa355f6",orgId:"675616D751E567410A490D4C@AdobeOrg",context:undefined,debugEnabled:"false",edgeDomain:"edge.adobedc.net"||'edge.adobedc.net',errorsEnabled:true,clickCollectionEnabled:true,downloadLinkQualifier:"\\.(exe|zip|wav|mp3|mov|mpg|avi|wmv|pdf|doc|docx|xls|xlsx|ppt|pptx)$",onBeforeEventSend:function(){},defaultConsent:"in",prehidingStyle:undefined,cookieDestinationsEnabled:true,urlDestinationsEnabled:true,idMigrationEnabled:true,thirdPartyCookiesEnabled:true,renderDecisions:false,decisionScopes:[],purchaseID:"",priceTotal:"",currencyCode:"",product:{name:[],SKU:[],quantity:[],priceTotal:[],lineItemId:[]},payment:{transactionID:[],paymentAmount:[],paymentType:[],currencyCode:[]},id_namespace:[],id:[],value:'',authenticatedState:[],primary:[],link_name:"",link_type:"",link_URL:"",link_value:"",command:"",datasetId:"",event_queue:[],event_type:"",mergeId:"",custom_data:{},commerce:{},account_name:'',pageName:'',clientID:'',xdm:{},data:{},edgeBasePath:'ee',documentUnloading:false,edgeConfigOverrides:{}};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:31:EXTENSIONS");utag.DB(data_layer);c=[];Object.keys(utag.loader.GV(u.map)).forEach(function(mapping_key){if(data_layer[mapping_key]!==undefined&&data_layer[mapping_key]!==''){var destinations=u.map[mapping_key].split(',');destinations.forEach(function(parameter){if(u.data.hasOwnProperty(parameter)||parameter.indexOf('.')>-1){u.map_func(parameter.split('.'),u.data,data_layer[mapping_key]);}else{u.map_func(parameter.split('.'),u.data.custom_data,data_layer[mapping_key]);}});}else{var event_destinations=mapping_key.split(':');if(event_destinations.length===2&&String(data_layer[event_destinations[0]])===String(event_destinations[1])){if(u.map[mapping_key]){u.data.event_queue=u.data.event_queue.concat(u.map[mapping_key].split(','));}}}});utag.DB("send:31:MAPPINGS");utag.DB(u.data);if(u.data.library_version===''){u.data.library_version=DEFAULT_LIBRARY_VERSION;}
u.data.base_url=u.data.base_url.replace("##utag_replace_library_version##",u.data.library_version);var delim=/\s*,\s*/;if(typeof u.data.instanceName==="string"){u.data.instanceName=u.data.instanceName.split(delim);}
if(typeof u.data.edgeConfigId==="string"){u.data.edgeConfigId=u.data.edgeConfigId.split(delim);}
if(typeof u.data.orgId==="string"){u.data.orgId=u.data.orgId.split(delim);}
u.data.purchaseID=u.data.purchaseID||data_layer._corder||"";u.data.priceTotal=u.data.priceTotal||data_layer._ctotal||"";u.data.currencyCode=u.data.currencyCode||data_layer._ccurrency||"";u.data.product.name=u.data.product.name.length?u.data.product.name:getProp(u.data,'xdm.productListItems.name',[]);u.data.product.SKU=u.data.product.SKU.length?u.data.product.SKU:getProp(u.data,'xdm.productListItems.SKU',[]);u.data.product.quantity=u.data.product.quantity.length?u.data.product.quantity:getProp(u.data,'xdm.productListItems.quantity',[]);u.data.product.priceTotal=u.data.product.priceTotal.length?u.data.product.priceTotal:getProp(u.data,'xdm.productListItems.priceTotal',[]);u.data.product.lineItemId=u.data.product.lineItemId.length?u.data.product.lineItemId:getProp(u.data,'xdm.productListItems.lineItemId',[]);if(u.data.product.name.length===0&&data_layer._cprodname!==undefined){u.data.product.name=data_layer._cprodname.slice(0);}
if(u.data.product.SKU.length===0&&data_layer._csku!==undefined){u.data.product.SKU=data_layer._csku.slice(0);}
if(u.data.product.quantity.length===0&&data_layer._cquan!==undefined){u.data.product.quantity=data_layer._cquan.slice(0);}
if(u.data.product.priceTotal.length===0&&data_layer._cprice!==undefined){u.data.product.priceTotal=data_layer._cprice.slice(0);}
if(u.data.product.lineItemId.length===0&&data_layer._ccat!==undefined){u.data.product.lineItemId=data_layer._ccat.slice(0);}
u.data.cookieDestinationsEnabled=u.toBoolean(u.data.cookieDestinationsEnabled)
u.data.urlDestinationsEnabled=u.toBoolean(u.data.urlDestinationsEnabled)
if((u.data.edgeConfigId.length<1||u.data.edgeConfigId[0]==="")||(u.data.orgId.length<1||u.data.orgId[0]==="")||(u.data.instanceName.length<1||u.data.instanceName[0]==="")){utag.DB(u.id+": Tag not fired: Required attribute Config ID or Org ID not populated");return;}
if(u.toBoolean(u.data.auto_page_tracking)&&a==="view"){u.data.event_queue.push("web.webpagedetails.pageViews");}
if(u.toBoolean(u.data.auto_purchase_tracking)&&u.data.purchaseID&&u.data.event_queue.indexOf("commerce.purchases")===-1){u.data.event_queue.push("commerce.purchases");}
if(typeof u.data.id_namespace==="string"){u.data.id_namespace=u.data.id_namespace.split(",");u.data.id=u.data.id.split(",");u.data.authenticatedState=u.data.authenticatedState.split(",");u.data.primary=u.data.primary.split(",");}
(function(n,o){o.forEach(function(o){n[o]||((n.__alloyNS=n.__alloyNS||[]).push(o),n[o]=function(){var u=arguments;return new Promise(function(i,l){n[o].q.push([i,l,u])})},n[o].q=[])})})(window,u.data.instanceName);for(var i=0;i<u.data.instanceName.length;i++){var instance=u.data.instanceName[i];if(!u.data.edgeConfigId[i]&&!u.data.orgId[i]){utag.DB(u.id+": Adobe Alloy: You are missing a matching Config ID or Org ID for this Instance Name. All subsequent tracking has been aborted.");break;}
if(!u.set_config){u.set_config=true;config={orgId:u.data.orgId[i],edgeConfigId:u.data.edgeConfigId[i],debugEnabled:u.toBoolean(u.data.debugEnabled),clickCollectionEnabled:u.toBoolean(u.data.clickCollectionEnabled),downloadLinkQualifier:u.data.downloadLinkQualifier,context:u.data.context,defaultConsent:u.data.defaultConsent,edgeDomain:u.data.edgeDomain,errorsEnabled:u.data.errorsEnable,idMigrationEnabled:u.toBoolean(u.data.idMigrationEnabled),onBeforeEventSend:u.data.onBeforeEventSend,prehidingStyle:u.data.prehidingStyle,thirdPartyCookiesEnabled:u.toBoolean(u.data.thirdPartyCookiesEnabled),edgeBasePath:u.data.edgeBasePath};if(!utag.ut.isEmptyObject(u.data.edgeConfigOverrides)){var reportSuites=getProp(u.data.edgeConfigOverrides,"com_adobe_analytics.reportSuites");if(!Array.isArray(reportSuites)&&!!reportSuites){u.data.edgeConfigOverrides.com_adobe_analytics.reportSuites=reportSuites
.split(',')
.map(function(item){return item.trim()});}
config.edgeConfigOverrides=u.data.edgeConfigOverrides;}
if(!u.data.cookieDestinationsEnabled){config.cookieDestinationsEnabled=u.toBoolean(u.data.cookieDestinationsEnabled);}
if(!u.data.urlDestinationsEnabled){config.urlDestinationsEnabled=u.toBoolean(u.data.urlDestinationsEnabled);}
window[instance]("configure",u.clearEmptyKeys(config));}
u.data.event_queue.forEach(function(event_type){var j,event_measure,event_data={},command=u.data.command||"sendEvent";if(event_type==="commerce.purchases"){event_data.xdm=createNest("commerce.order");}else{event_data.xdm=createNest(event_type);}
if(u.data.eVars||u.data.props||u.data.contextData){var analytics={analytics:{customDimensions:{eVars:u.data.eVars||{},props:u.data.props||{}}}};utag.ut.merge(analytics.analytics,u.data.contextData,1);event_data.xdm._experience=analytics;}
if(u.data.account_name){event_data.xdm[u.data.account_name]={};if(u.data.id_namespace){event_data.xdm[u.data.account_name].id_namespace=u.data.id_namespace;}
if(u.data.clientID){event_data.xdm[u.data.account_name].clientID=u.data.clientID;}}
if(standard_commerce_event_match.test(event_type)){if(event_type==="commerce.purchases"){event_data.xdm.commerce.order.purchaseID=u.data.purchaseID;event_data.xdm.commerce.order.currencyCode=u.data.currencyCode;event_data.xdm.commerce.order.priceTotal=u.data.priceTotal;event_data.xdm.commerce.order.payments=[];for(j=0;j<u.data.payment.paymentType.length;j++){event_data.xdm.commerce.order.payments.push({transactionID:u.data.payment.transactionID[j],paymentAmount:u.data.payment.paymentAmount[j],paymentType:u.data.payment.paymentType[j],currencyCode:u.data.payment.currencyCode[j]});}}else{event_measure=event_type.split(".")[1];var ecommerceEventObject=u.data.commerce[event_measure]||{};event_data.xdm.commerce[event_measure]={value:ecommerceEventObject.value||u.data.value||1,id:ecommerceEventObject.id||u.data.id||""};}
event_data.xdm.productListItems=u.productList();}else if(event_type==="web.webInteraction.linkClicks"){event_data.xdm.web.name=u.data.link_name;event_data.xdm.web.URL=u.data.link_URL;event_data.xdm.web.type=u.data.link_type||"other";event_data.xdm.web.webInteraction.linkClicks.value=u.data.value||1;}else if(event_type==="web.webpagedetails.pageViews"){event_data.xdm.web.webpagedetails.pageViews.value=u.data.value||1;}else if(event_type==="identityMap"){if(u.data.id_namespace.length>0){u.data.id_namespace.forEach(function(identity,i){event_data.xdm.identityMap[identity]=[];event_data.xdm.identityMap[identity].push({id:u.data.id[i],authenticatedState:u.data.authenticatedState[i],primary:u.data.primary[i]});});}}
event_data.xdm.eventType=event_type;if(u.data.datasetId){event_data.datasetId=u.data.datasetId;}
if(u.data.mergeId){event_data.mergeId=u.data.mergeId;}
if(isTrue(u.data.renderDecisions)){event_data.renderDecisions=true;}
if(u.data.decisionScopes.length>0){event_data.decisionScopes=u.data.decisionScopes}
if(u.toBoolean(u.data.documentUnloading)){event_data.documentUnloading=u.toBoolean(u.data.documentUnloading);}
if(!utag.ut.isEmptyObject(u.data.custom_data)){event_data.data=u.data.custom_data;}
event_data.xdm=u.deepMergeObject(event_data.xdm,u.data.xdm)
event_data.data=u.deepMergeObject(event_data.data||{},u.data.data)
var eventSpecificObject=getProp(u.data,event_type,{})
event_data=u.deepMergeObject(event_data,eventSpecificObject,1)
u.flattenTargetValues(event_data.data);window[instance](command,event_data)
.then(u.data.commandCallback)
.catch(function(error){utag.DB(error);});});}
if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":null,"loc":"script","id":"utag_31","attrs":{}});}
utag.DB("send:31:COMPLETE");}};function createNest(input){var nest={},name_path=input.split("."),context=nest;for(var i=0;i<name_path.length;i++){context[name_path[i]]={};context=context[name_path[i]];}
context.value=1
return nest;}
function isTrue(input){if(typeof input==="boolean"){return input;}else if(typeof input==="string"&&input.toLowerCase()==="true"){return true;}else{return false;}}
utag.o[loader].loader.LOAD(id);}("31","usbank.dotcom-v2"));}catch(error){utag.DB(error);}
